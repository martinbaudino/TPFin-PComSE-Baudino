<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TPFin_PComSE: inc/ADS1018.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TPFin_PComSE<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">Driver SPI para ADS1018 en STM32F429ZI</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('_a_d_s1018_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ADS1018.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;stm32f4xx_hal.h&quot;</code><br />
</div>
<p><a href="_a_d_s1018_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5cb746b84a52daa8f135e423c12c69e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_s1018_8h.html#a5cb746b84a52daa8f135e423c12c69e0">ADS_FULLDATA</a>&#160;&#160;&#160;3U</td></tr>
<tr class="separator:a5cb746b84a52daa8f135e423c12c69e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9d78c5bd5a2bb48c82a26f637612343"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_s1018_8h.html#ad9d78c5bd5a2bb48c82a26f637612343">ADS_NODATA</a>&#160;&#160;&#160;0U</td></tr>
<tr class="separator:ad9d78c5bd5a2bb48c82a26f637612343"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a568d84f20f044710cfb5a82f9b4a513c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_s1018_8h.html#a568d84f20f044710cfb5a82f9b4a513c">init_ads</a> (void)</td></tr>
<tr class="memdesc:a568d84f20f044710cfb5a82f9b4a513c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inicializa el ADS1018 de manera abstracta.  <a href="_a_d_s1018_8h.html#a568d84f20f044710cfb5a82f9b4a513c">More...</a><br /></td></tr>
<tr class="separator:a568d84f20f044710cfb5a82f9b4a513c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f40d2e48fd47ed45b936fff1bf3d7c6"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_s1018_8h.html#a0f40d2e48fd47ed45b936fff1bf3d7c6">read_ads</a> (uint16_t *dataBuffer, uint8_t buffSize)</td></tr>
<tr class="memdesc:a0f40d2e48fd47ed45b936fff1bf3d7c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lee el ADS1018 de manera abstracta.  <a href="_a_d_s1018_8h.html#a0f40d2e48fd47ed45b936fff1bf3d7c6">More...</a><br /></td></tr>
<tr class="separator:a0f40d2e48fd47ed45b936fff1bf3d7c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38a074e9bd8eda193cc0b12043d2234c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_s1018_8h.html#a38a074e9bd8eda193cc0b12043d2234c">init_ads_spi</a> (void)</td></tr>
<tr class="memdesc:a38a074e9bd8eda193cc0b12043d2234c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Inicialización del módulo de hardware SPI4, conectado a ADS1018.  <a href="_a_d_s1018_8h.html#a38a074e9bd8eda193cc0b12043d2234c">More...</a><br /></td></tr>
<tr class="separator:a38a074e9bd8eda193cc0b12043d2234c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa74630614e18c3c845aa309464b539ab"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_s1018_8h.html#aa74630614e18c3c845aa309464b539ab">tx_rx_spi</a> (uint16_t configWord)</td></tr>
<tr class="memdesc:aa74630614e18c3c845aa309464b539ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmisión y recepción de datos con el ADS1018 por SPI4.  <a href="_a_d_s1018_8h.html#aa74630614e18c3c845aa309464b539ab">More...</a><br /></td></tr>
<tr class="separator:aa74630614e18c3c845aa309464b539ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7aad8f6f6cd4186ca5db864f4786a1c"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_a_d_s1018_8h.html#aa7aad8f6f6cd4186ca5db864f4786a1c">read_ads_data</a> (uint16_t *readBuffer, uint8_t buffSize)</td></tr>
<tr class="memdesc:aa7aad8f6f6cd4186ca5db864f4786a1c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convierte los canales con manejo de señales de bajo nivel.  <a href="_a_d_s1018_8h.html#aa7aad8f6f6cd4186ca5db864f4786a1c">More...</a><br /></td></tr>
<tr class="separator:aa7aad8f6f6cd4186ca5db864f4786a1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a5cb746b84a52daa8f135e423c12c69e0" name="a5cb746b84a52daa8f135e423c12c69e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cb746b84a52daa8f135e423c12c69e0">&#9670;&#160;</a></span>ADS_FULLDATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADS_FULLDATA&#160;&#160;&#160;3U</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Cantidad de datos a leer: por ahora siempre se leen 3 valores </p>

</div>
</div>
<a id="ad9d78c5bd5a2bb48c82a26f637612343" name="ad9d78c5bd5a2bb48c82a26f637612343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d78c5bd5a2bb48c82a26f637612343">&#9670;&#160;</a></span>ADS_NODATA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ADS_NODATA&#160;&#160;&#160;0U</td>
        </tr>
      </table>
</div><div class="memdoc">
<p >Cantidad de datos leídos cuando hubo algún error, ninguno </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a568d84f20f044710cfb5a82f9b4a513c" name="a568d84f20f044710cfb5a82f9b4a513c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a568d84f20f044710cfb5a82f9b4a513c">&#9670;&#160;</a></span>init_ads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool init_ads </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inicializa el ADS1018 de manera abstracta. </p>
<dl class="section return"><dt>Returns</dt><dd>Verdadero o falso, depende del resultado de la inicialización del hardware específico </dd></dl>

</div>
</div>
<a id="a38a074e9bd8eda193cc0b12043d2234c" name="a38a074e9bd8eda193cc0b12043d2234c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38a074e9bd8eda193cc0b12043d2234c">&#9670;&#160;</a></span>init_ads_spi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool init_ads_spi </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Inicialización del módulo de hardware SPI4, conectado a ADS1018. </p>
<p >Según la hoja de datos el ADS1018 trabaja con SPI en Modo 1, con el reloj en bajo cuando está inactivo (CPOL=0), muestrea la señal de entrada en flanco negativo y activa la de salida en el flanco positivo del reloj (CPHA=1).</p>
<dl class="section return"><dt>Returns</dt><dd>Verdadero o falso, depende del resultado de la inicialización del periférico SPI4 </dd></dl>

</div>
</div>
<a id="a0f40d2e48fd47ed45b936fff1bf3d7c6" name="a0f40d2e48fd47ed45b936fff1bf3d7c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f40d2e48fd47ed45b936fff1bf3d7c6">&#9670;&#160;</a></span>read_ads()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t read_ads </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>dataBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>buffSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Lee el ADS1018 de manera abstracta. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dataBuffer</td><td>Memoria reservada para lectura de datos </td></tr>
    <tr><td class="paramname">buffSize</td><td>Cantidad de valores a leer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Verdadero o falso, depende del resultado de la lectura del hardware </dd></dl>

</div>
</div>
<a id="aa7aad8f6f6cd4186ca5db864f4786a1c" name="aa7aad8f6f6cd4186ca5db864f4786a1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7aad8f6f6cd4186ca5db864f4786a1c">&#9670;&#160;</a></span>read_ads_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t read_ads_data </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>readBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>buffSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convierte los canales con manejo de señales de bajo nivel. </p>
<p >Adición ex post: Para leer las mediciones del ADS1018 se debe enviar una palabra de configuración que dispara la conversión analógica a digital. Minentras eso sucede, se recibe el valor de la conversión anterior. Por ello en esta configuración de disparo único, se envíean 4 palabras de configuración, se descarta el primer dato, y la cuarta palabra de configuración es un valor bobo solo para leer el resultado de la conversión.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">readBuffer</td><td>Memoria reservada para lectura de datos </td></tr>
    <tr><td class="paramname">buffSize</td><td>Cantidad de valores a leer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd></dd></dl>
<p >Palabras de configuración para cada lectura del ADS1018 0: Adquisición del Canal 2, sin lectura 1: Adquisición del Canal 1, lectura del Canal 2 2: Adquisición del sensor de temperatura interno, lectura del Canal 1 3: Lectura del sensor de temperatura interno</p>
<p >Envía la primera palabra de configuración. Se descarta el dato recibido porque es de la medición anterior</p>
<p >Envía sucesivas palabras de configuración y recupera datos útiles</p>
<p >Espera que indique dato nuevo disponible</p>
<p >El ADS1018 es un ADC de 12 bits y devuelve valores adquiridos en una palabra de 16 bits justificados a la izquierda: es necesario corregir esto antes de devolver los datos.</p>
<p >Al finalizar el ciclo de las 4 conversiones se deshabilita el módulo SPI</p>
<p >Devuelve siempre que se leyeron 3 datos</p>

</div>
</div>
<a id="aa74630614e18c3c845aa309464b539ab" name="aa74630614e18c3c845aa309464b539ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa74630614e18c3c845aa309464b539ab">&#9670;&#160;</a></span>tx_rx_spi()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t tx_rx_spi </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>configWord</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmisión y recepción de datos con el ADS1018 por SPI4. </p>
<p >IMPORTANTE: El ADS1018 opera sobre la línea MISO no solo para transmitir sus lecturas, sino también para indicar que terminó de realizar una conversión. Esto lo hace poniendo en alto la línea MISO cuando empieza a convertir y luego en bajo cuando termina, en ambos casos con ausencia de clock cuando se trata del modo de disparo único. Como se requiere realizar cuatro mediciones consecutivas, se debe generar un ciclo BAJO-ALTO-BAJO entre las mediciones de un tiempo suficientement corto como para que no se generen pulsos de clock. Esto se hace con un retardo bloqueante de alrededor de 600ns.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">configWord</td><td>Palabra de configuración para captura del ADS1018 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Valor adquirido según anterior palabra de configuración </dd></dl>
<p >Hace que el módulo SPI genere un pulso de 600ns sobre la señal de habilitación</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_bfccd401955b95cf8c75461437045ac0.html">inc</a></li><li class="navelem"><a class="el" href="_a_d_s1018_8h.html">ADS1018.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
